<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loanding...</title>
    <link rel="stylesheet" href="/Frontend/loanding/styles.css" />
    <link rel="icon" href="/Frontend/img/face.ico" type="image/x-icon">
</head>
<body>
    <div class="container text-center">
      <div style="margin-top:100px">
        <div class="loader rspin">
          <span class="c"></span>
          <span class="d spin"><span class="e"></span></span>
          <span class="r r1"></span>
          <span class="r r2"></span>
          <span class="r r3"></span>
          <span class="r r4"></span>
        </div>
      </div>
      <script>
        async function obtenerYMostrarToken() {
          const token = sessionStorage.getItem("token");

          if (!token) {
            window.location.href = "/Frontend/login/login.html";
            return;
          }

          var myHeaders = new Headers();
          myHeaders.append("Authorization", "Bearer " + token);

          var requestOptions = {
            method: "POST",
            headers: myHeaders,
            redirect: "follow",
          };

          await fetch("https://c1670python.pythonanywhere.com/auth/rol", requestOptions)
            .then((response) => response.json())
            .then((data) => {
              if (data.role === "Paciente") {
                window.location.href = "/Frontend/cliente-panel/cliente-panel-principal.html";
              } else if (data.role == "Admin") {
                window.location.href = "/Frontend/admin-panel/admin-panel-all-users.html";
              } else {
                console.log("Rol desconocido");

                window.location.href = "/";
              }
            })
            .catch((error) => console.log("error", error));
        }

        window.onload = () => {
          obtenerYMostrarToken();
        };
      </script>
      <!-- <script type="module" src="segurity.js"></script> -->
</body>
</html>